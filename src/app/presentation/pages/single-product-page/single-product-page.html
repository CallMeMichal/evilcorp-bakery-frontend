<div class="page-container single-product-container">
  <app-header></app-header>

  <!-- Loading State -->
  <div class="loading-wrapper" *ngIf="isLoading">
    <div class="loading-spinner">
      <i class="fas fa-spinner fa-spin"></i>
      <p>Loading product details...</p>
    </div>
  </div>

  <!-- Error State -->
  <div class="error-wrapper" *ngIf="error && !isLoading">
    <div class="error-content">
      <i class="fas fa-exclamation-circle"></i>
      <h2>Oops! Something went wrong</h2>
      <p>{{ error }}</p>
      <button class="btn-back" (click)="goBack()">
        <i class="fas fa-arrow-left"></i> Back to Products
      </button>
    </div>
  </div>

  <!-- Product Content -->
  <section class="product-section" *ngIf="product && !isLoading && !error">
    <div class="container">
      
      <!-- Breadcrumb -->
      <nav class="breadcrumb">
        <a routerLink="/">Home</a>
        <i class="fas fa-chevron-right"></i>
        <a routerLink="/products">Products</a>
        <i class="fas fa-chevron-right"></i>
        <span>{{ product.name }}</span>
      </nav>

      <div class="product-details">
        
        <!-- Product Images -->
        <div class="product-gallery">
          <div class="main-image">
            <img [src]="selectedImage" [alt]="product.name" />
            <div class="stock-badge" [ngClass]="getStockClass()">
              {{ getStockStatus() }}
            </div>
          </div>
          
          <!-- Thumbnail images - if you have multiple images in the future -->
          <div class="thumbnail-images">
            <div class="thumbnail active">
              <img [src]="product.base64Image" [alt]="product.name" />
            </div>
          </div>
        </div>

        <!-- Product Info -->
        <div class="product-info">
          <h1 class="product-title">{{ product.name }}</h1>
          
          <div class="product-price-section">
            <span class="product-price">{{ formatPrice(product.price) }}</span>
            <div class="product-stock" [ngClass]="getStockClass()">
              <i class="fas fa-circle"></i>
              <span>{{ getStockStatus() }}</span>
            </div>
          </div>

          <div class="product-description">
            <h3>Description</h3>
            <p>{{ product.description }}</p>
          </div>

          <div class="product-meta">
            <div class="meta-item">
              <i class="fas fa-layer-group"></i>
              <div class="meta-details">
                <span class="meta-label">Category</span>
                <span class="meta-value">{{ product.category }}</span>
              </div>
            </div>
            <div class="meta-item">
              <i class="fas fa-warehouse"></i>
              <div class="meta-details">
                <span class="meta-label">Available Stock</span>
                <span class="meta-value" [ngClass]="getStockClass()">
                  {{ product.stock }} units
                </span>
              </div>
            </div>
          </div>

          <!-- Quantity Selector -->
          <div class="quantity-section">
            <label>Quantity:</label>
            <div class="quantity-controls">
              <button 
                class="qty-btn" 
                (click)="decreaseQuantity()"
                [disabled]="quantity <= 1">
                <i class="fas fa-minus"></i>
              </button>
              <input 
                type="number" 
                class="qty-input" 
                [(ngModel)]="quantity"
                [max]="product.stock"
                min="1"
                readonly
              />
              <button 
                class="qty-btn" 
                (click)="increaseQuantity()"
                [disabled]="quantity >= product.stock || product.stock === 0">
                <i class="fas fa-plus"></i>
              </button>
            </div>
          </div>

          <!-- Action Buttons -->
          <div class="action-buttons">
            <button 
              class="btn-add-to-cart" 
              [disabled]="product.stock === 0"
              (click)="addToCart()">
              <i class="fas fa-shopping-cart"></i>
              <span *ngIf="product.stock > 0">Add to Cart</span>
              <span *ngIf="product.stock === 0">Out of Stock</span>
            </button>
            <button class="btn-back-outline" (click)="goBack()">
              <i class="fas fa-arrow-left"></i>
              Continue Shopping
            </button>
          </div>

          <!-- Additional Info -->
          <div class="additional-info">
            <div class="info-item">
              <i class="fas fa-truck"></i>
              <div>
                <strong>Free Delivery</strong>
                <p>On orders over $50</p>
              </div>
            </div>
            <div class="info-item">
              <i class="fas fa-shield-alt"></i>
              <div>
                <strong>Quality Guarantee</strong>
                <p>Fresh products daily</p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <app-footer></app-footer>
</div>